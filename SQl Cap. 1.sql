--F5 Para Executar

--Criando Tabela
CREATE TABLE TALUNO
(
 COD_ALUNO INTEGER NOT NULL PRIMARY KEY,--Chave Primaria
 NOME VARCHAR(30),
 CIDADE VARCHAR(30),
 CEP VARCHAR(10)
);

--Inserindo linha na tabela 
INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
VALUES (1,'VALTER','CACHOEIRINHA','94985214');

INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
VALUES (2,'PAULO','GRAVATAI','94985524');

INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
VALUES (3,'SOFIA','CACHOEIRINHA','85985214');

SELECT * FROM TALUNO;--Selecionando a Tabela

CREATE TABLE TCURSO
(
 COD_CURSO INTEGER NOT NULL PRIMARY KEY,
 NOME VARCHAR(30),
 VALOR NUMERIC(8,2),
 CARGA_HORARIA INTEGER
);

INSERT INTO TCURSO VALUES(1,'ORACLE SQL',500,30);
INSERT INTO TCURSO VALUES(2,'JAVA INTRODUÇÃO',450,25);
INSERT INTO TCURSO VALUES(3,'ORACLE PL/SQL',800,60);
INSERT INTO TCURSO VALUES(4,'POWER BY',600,45);

SELECT * FROM TCURSO;

CREATE TABLE TCONTRATO
(
 COD_CONTRATO INTEGER NOT NULL PRIMARY KEY,
 DATA DATE,
 COD_ALUNO INTEGER,
 TOTAL NUMBER(8,2),
 DESCONTO NUMBER(5,2)
); 

INSERT INTO TCONTRATO VALUES(2,SYSDATE -60, 1, 800,20);
INSERT INTO TCONTRATO VALUES(3,SYSDATE -45, 3, 600,18);
INSERT INTO TCONTRATO VALUES(4,SYSDATE -15, 4, 900,22);
INSERT INTO TCONTRATO VALUES(5,SYSDATE -152,2, 700,18);
INSERT INTO TCONTRATO VALUES(6,SYSDATE -80, 3, 535,10);
INSERT INTO TCONTRATO VALUES(7,SYSDATE,     4, 380,5);

SELECT * FROM TCONTRATO;

--Inserir coluna na tabela
ALTER TABLE TCONTRATO ADD COL_TESTE VARCHAR(30);
--EXcluir coluna da tabela
ALTER TABLE TCONTRATO DROP COLUMN COL_TESTE;
--Alterar nome de coluna
ALTER TABLE TALUNO RENAME COLUMN NOME TO NOME2;
ALTER TABLE TALUNO RENAME COLUMN NOME2 TO NOME;

--Excluir Tabela
--DROP TABLE NOME_TABELA;

--Criando Sequencia
CREATE SEQUENCE SEQ_ALU START WITH 4;
--Inserindo com a sequencia criada
INSERT INTO TALUNO(COD_ALUNO,NOME,CIDADE,CEP)
VALUES(SEQ_ALU.NEXTVAL,'EMILI','SAPIRANGA','25698741');

--Ver valor atual da sequencia
SELECT SEQ_ALU.CURRVAL FROM DUAL;

--Exibir data/hora
SELECT SYSDATE FROM DUAL
--Altera o formato do horario
ALTER SESSION SET NLS_DATE_FORMAT ='DD/MM/YYYY ';
SELECT SYSDATE FROM DUAL;

--Confirma alterações realizadas
COMMIT;
--Desfaz alteraçoes realizadas
ROLLBACK;

--Excluir registro da tabela
DELETE FROM TALUNO
WHERE COD_ALUNO = 5;

SELECT * FROM TALUNO;

ROLLBACK;

SELECT * FROM TALUNO WHERE NOME = 'EMILI';

--ROLLBACK SO FUNCIONA SE NÃO FOR FEITO O COMMIT, DEPOIS DO COMMIT NÃO TEM VOLTA

CREATE TABLE TITEM
(
 COD_ITEM INTEGER NOT NULL PRIMARY KEY,
 COD_CURSO INTEGER,
 COD_CONTRATO INTEGER,
 VALOR NUMBER(8,2)
);

INSERT INTO TITEM VALUES(1,1,1, 500);
INSERT INTO TITEM VALUES(2,1,2,500);
INSERT INTO TITEM VALUES(3,3,3,1500);
INSERT INTO TITEM VALUES(4,4,4,1600);
INSERT INTO TITEM VALUES(5,1,5,500);
INSERT INTO TITEM VALUES(6,1,6,600);
INSERT INTO TITEM VALUES(7,2,6,500);
INSERT INTO TITEM VALUES(8,3,7,500);

SELECT * FROM TITEM;
--Seleciona na tabela tcontrato o contrato de codigo nº2
SELECT * FROM TCONTRATO
WHERE COD_CONTRATO = 2;

--Alterar registro da trabela
UPDATE TCONTRATO SET 
  DESCONTO = 18
WHERE COD_CONTRATO = 2;  

UPDATE TCONTRATO SET
  DESCONTO = 20,
  DATA = '05/06/2013',
  TOTAL = 750
WHERE COD_CONTRATO = 2; 
--Alterou o nome da cidade
UPDATE TALUNO SET
  CIDADE = 'CRUZ ALTA'
WHERE UPPER(CIDADE) = 'SAPIRANGA';

SELECT * FROM TALUNO
--Alterou o registro nome do aluno com codigo 5
UPDATE TALUNO SET
  NOME = 'BELA'
WHERE COD_ALUNO = 5;
--Atualizou o valor do curso nº 5
UPDATE TCURSO SET 
  VALOR =  450.50
WHERE COD_CURSO = 1;  

SELECT * FROM TCURSO;





